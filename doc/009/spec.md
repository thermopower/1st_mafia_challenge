# 광고주 체험단 상세 및 모집 관리 - 상세 유스케이스

## Primary Actor
광고주 프로필 등록 완료자

## Precondition
- 광고주 프로필 등록 완료
- 로그인 상태
- 본인이 등록한 체험단 선택

## Trigger
체험단 관리 페이지에서 특정 체험단 클릭

## Main Scenario
1. 체험단 상세 관리 페이지 로드
2. 체험단 기본 정보 조회 및 수정 가능
3. 지원자 현황 테이블 표시 (전체/신청완료/선정/반려)
4. 모집 상태별 지원자 수 통계 제공
5. 지원자별 상세 정보 조회 (이름, 채널 정보, 지원동기, 방문예정일)
6. 모집 상태 변경 기능 (모집종료, 조기종료)
7. 인플루언서 선정 기능 (모집종료 후 사용 가능)
8. 선정 완료 시 자동 상태 변경
9. 지원자 알림 발송 (선정/반려 시)

## Edge Cases
- 체험단 삭제됨: 404 페이지 또는 관리 목록으로 리다이렉션
- 권한 없음: 본인이 등록하지 않은 체험단 접근 불가
- 지원자 없음: 빈 상태 메시지와 모집 기간 연장 제안
- 선정 중 오류: 트랜잭션 롤백 후 재시도 안내
- 알림 발송 실패: 재발송 버튼 제공

## Business Rules
- 광고주 본인이 등록한 체험단만 관리 가능
- 모집중 상태에서만 모집종료 가능
- 조기종료는 시작일 이후 언제든지 가능
- 모집종료 후에만 인플루언서 선정 가능
- 선정 인원은 모집 인원 이하로 제한
- 선정 완료 시 체험단 상태 자동 변경 (선정완료)
- 반려된 지원자는 재지원 가능
- 선정/반려 알림은 필수 발송

## Sequence Diagram
```
@startuml
actor "User" as U
participant "Frontend" as FE
participant "Backend" as BE
participant "Database" as DB
participant "Notification Service" as NS

U -> FE: 체험단 클릭 (관리 페이지에서)
FE -> BE: 체험단 상세 관리 정보 요청\n(체험단 ID 포함)

BE -> BE: 사용자 권한 확인\n(체험단 등록자 확인)

BE -> DB: 체험단 정보 조회
DB -> BE: 체험단 데이터 반환

BE -> DB: 지원자 목록 조회\n(체험단 ID 기준, 상태별)
DB -> BE: 지원자 정보 반환

BE -> BE: 응답 데이터 가공\n(인플루언서 정보 조인)
BE -> FE: 상세 관리 정보 응답

FE -> U: 체험단 상세 관리 페이지 표시

alt 모집 종료 필요시
    U -> FE: 모집종료 버튼 클릭
    FE -> BE: 모집상태 변경 요청

    BE -> DB: 체험단 상태 업데이트\n(모집종료로 변경)
    DB -> BE: 업데이트 완료 응답

    BE -> FE: 상태 변경 완료 응답
    FE -> U: 선정 기능 활성화
end

U -> FE: 인플루언서 선정 실행
FE -> BE: 선정 요청\n(선정 인플루언서 ID 목록)

BE -> BE: 비즈니스 규칙 검증\n(모집상태, 인원 제한 등)

BE -> DB: 지원자 상태 업데이트\n(선정된 사용자들을 '선정'으로 변경)
DB -> BE: 업데이트 완료 응답

BE -> DB: 체험단 상태 변경\n(선정완료로 변경)
DB -> BE: 변경 완료 응답

BE -> NS: 선정/반려 알림 발송 요청
NS -> NS: 알림 발송 처리

BE -> FE: 선정 완료 응답
FE -> U: 선정 완료 메시지 및 업데이트된 목록 표시

@enduml
```
